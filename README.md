# ATON Test Task


1. [**Задание.**](#01)
2. [**Используемые технологии и подходы.**](#02)
3. [**Инструкция к применению.**](#03)

## 1. Задание.<a name="01"></a>

- Примечание: Желательно выложить код на гитхаб или в любую доступную систему контроля
версий.
- Задание: Написать `Web API` сервис на `.NET Core 3.1` или выше, реализующий `API` методы `CRUD` над
сущностью `Users`, доступ к API должен осуществляться через интерфейс `Swagger`.
- Все действия могут происходить в оперативной памяти и не сохраняться при остановке
приложения (по желанию подключить любую базу данных).
- Предварительно должен быть создан пользователь `Admin`, от имени которого будут вначале
происходить действия.

`CRUD` методы контроллера `UsersController`

!!!Во всех запросах должны присутствовать параметры логин и пароль выполняющего запрос!!!
- (по желанию возвращать текст ошибки при невозможности выполнить действие)
- (по желанию можно добавить выдачу и использование токена)

`Create`
- Создание пользователя по логину, паролю, имени, полу и дате рождения + указание будет ли
пользователь админом (Доступно Админам)

`Update-1`
- Изменение имени, пола или даты рождения пользователя (Может менять Администратор, либо
лично пользователь, если он активен (отсутствует RevokedOn))
- Изменение пароля (Пароль может менять либо Администратор, либо лично пользователь, если
он активен (отсутствует RevokedOn))
- Изменение логина (Логин может менять либо Администратор, либо лично пользователь, если
он активен (отсутствует RevokedOn), логин должен оставаться уникальным)

`Read`
- Запрос списка всех активных (отсутствует RevokedOn) пользователей, список отсортирован по
CreatedOn (Доступно Админам)
- Запрос пользователя по логину, в списке долны быть имя, пол и дата рождения статус активный
или нет (Доступно Админам)
- Запрос пользователя по логину и паролю (Доступно только самому пользователю, если он
активен (отсутствует RevokedOn))
- Запрос всех пользователей старше определённого возраста (Доступно Админам)

`Delete`
- Удаление пользователя по логину полное или мягкое (При мягком удалении должна
происходить простановка RevokedOn и RevokedBy) (Доступно Админам)

`Update-2`
- Восстановление пользователя - Очистка полей (RevokedOn, RevokedBy) (Доступно Админам)
Поля сущности User

```
Guid - Guid - Уникальный идентификатор пользователя
Login - string - Уникальный Логин (запрещены все символы кроме латинских букв и цифр),
Password - string - Пароль(запрещены все символы кроме латинских букв и цифр),
Name - string - Имя (запрещены все символы кроме латинских и русских букв)
Gender - int - Пол 0 - женщина, 1 - мужчина, 2 - неизвестно
Birthday - DateTime? - поле даты рождения может быть Null
Admin - bool - Указание - является ли пользователь админом
CreatedOn - DateTime - Дата создания пользователя
CreatedBy - string - Логин Пользователя, от имени которого этот пользователь создан
ModifiedOn - DateTime? - Дата изменения пользователя
ModifiedBy - string? - Логин Пользователя, от имени которого этот пользователь изменён
RevokedOn - DateTime?- Дата удаления пользователя
RevokedBy - string? - Логин Пользователя, от имени которого этот пользователь удалён
```

## 2. Используемые технологий и подходы. <a name="02"></a>

WebAPI создано по принципу чистой архитектуры и разделено на четырех слоя.

Слои:
- 'WebApi' - слоя предоставляющий endpoint
- 'Application' - слои предоставляющий сервисы и use cases API
- 'Infrastructure' - слои доступа к данным
- 'Domain' - слои представляющий бизнес логику API

Также в проекте есть юнит тесты для Infrastructre слоя, находятся они в '.test/InfrastructureTest'

Использована база данных 'PostgreSQL'.

Развертывание приложения реализовано при помощи 'Docker'.

Доступ к ресурсам происходит при помощи 'JWT'

## 3. Инструкция к применению. <a name="03"></a>

Для того, чтобы запустить докер контейнер, необходимо в корневой папке проекта в CMD ввести:

```
docker compose up
```

После запуска контейнера можно обратиться к сваггеру: 

http://localhost:7059/swagger/index.html

Для получени JWT токена для мокового аккаунта админа используем api/user/login пост запрос с данными 

```jsom
{
  "login": "Admin",
  "password": "Admin"
}
```

Вводим полученный JWT токен в поле, появляющиеся после нажатия на кнопку 'Authorize'
